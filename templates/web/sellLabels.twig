{% extends "layout/layout.twig" %}

{% block css %}
	{% webpack_entry_css 'layout/datatables' %}
{% endblock %}

{% block js %}
	{% webpack_entry_js 'layout/datatables' %}
	{% webpack_entry_js 'web/sellLabels' %}
{% endblock %}

{% block content %}
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-12">
				<h2>
					<i class="fas fa-cart-arrow-down"></i>
					Sell Labels list</h2>
				<form action="select_label_for_sells" method="get" id="{{ sellRow.id }}">
					<input type="hidden" id="productID" name="ProductID" value="{{ sellRow.product_id }}">
					<input type="hidden" id="sellID" name="sell_id" value="{{ sellRow.id }}">
				</form>
				<button type="submit" id="addBt" form="{{ sellRow.id }}" class="btn btn-dark btn-sm" data-toggle="modal" data-target="#addSellLabels">
					<i style="font-size:15px; width:20px;" class="fas fa-plus"></i>
					Add Sell Labels</button>

				{% if sellRow.total_qty == totalQtyLabelsell[0] and sellRow.total_qty != "0" %}
					<button type="button" id="conBt" class="btn btn-success btn-sm" data-toggle="modal" data-target="#conFirmSellLabel" name="{{ label|json_encode }}">
						<i style="font-size:15px; width:20px;" class="fas fa-check"></i>Confirm
					</button>
				{% endif %}
			<hr>
			<div>
				<h5>{{ sellRow.sell_no  ~ '(' ~ sellRow.sell_status ~ ')'}}
				</h5>
				<span>{{sellRow.part_name ~ '(' ~ sellRow.part_code ~ ')'}}</span><br>
				<span>{{'Sell Date: ' ~ sellRow.sell_date}}</span><br>
				<span>{{'Total Quantity: ' ~ sellRow.total_qty ~ '/' ~ totalQtyLabelsell[0]}}</span>
			</div>
			<hr>
			<table id="my-data-table" class="table table-striped table-bordered dt-responsive nowrap dataTable no-footer dtr-inline collapsed">
				<thead>
					<tr>
						<th>Label No</th>
						<th>Due Date</th>
						<th>LotNO/MergeNo</th>
						<th>Quantity</th>
						<th>Label Type</th>
						{% if sellRow.sell_status != "SELECTED_LABEL" %}
							<th>Operation</th>
						{% endif %}
					</tr>
				</thead>
				<tbody>
					{% for selllabel in sellLabels[0] %}
						<tr>

							<td>{{ selllabel.label_no }}</td>
							<td>{{ selllabel.issue_date }}</td>
							<td>{{ selllabel.lot_no }}</td>
							<td>{{ selllabel.quantity}}</td>
							<td>{{ selllabel.label_type}}</td>
							{% if sellRow.sell_status != "SELECTED_LABEL" %}
								<td>
									<button type="button" id="removeBt" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#removeSellLabels" name="{{ selllabel|json_encode }}">
										<i style="font-size:15px; width:20px;" class="fas fa-trash"></i>
									</button>
								</td>
							{% endif %}
						</tr>
					{% endfor %}
					{% for selllabel in sellLabels[1] %}
						<tr>
							<td>{{ selllabel.label_no }}</td>
							<td>{{ selllabel.merge_date }}</td>
							<td>{{ selllabel.merge_no }}</td>
							<td>{{ selllabel.quantity}}</td>
							<td>{{ selllabel.label_type}}</td>
							{% if sellRow.sell_status != "SELECTED_LABEL" %}
								<td>
									<button type="button" id="removeBt" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#removeSellLabels" name="{{ selllabel|json_encode }}">
										<i style="font-size:15px; width:20px;" class="fas fa-trash"></i>
									</button>
								</td>
							{% endif %}
						</tr>
					{% endfor %}
				</tbody>
				<tfoot></tfoot>
			</table>
			<form id="form-black" class="form-inline float-none" action="sells" method="get">
				<button type="submit" class="btn btn-primary" id="black">
					<i class="fas fa-arrow-left"></i>
					Back</button>
			</form>
			<p></p>
		</div>
	</div>
</div>

<!-- Modal Remove Label No Sell -->
<div class="modal fade" id="removeSellLabels">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<form
				id="form-removeSellLabels" action="remove_sell_label" method="post">
				<!-- Modal Header -->
				<div class="modal-header">
					<h4 class="modal-title">Delete Label For Sell</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				<!-- Modal body -->
				<div class="modal-body">
					<div class="form-sell">
						<input type="hidden" id="removeLabelID" name="id">
						<input type="hidden" id="addSellID" name="sell_id" value="{{sellRow.id}}">
						<label for="sellNo">Do you want to remove Label No:
							<span id="removeLabelNo"></span>
						</div>

					</div>
					<div class="modal-footer">
						<button type="submit" class="btn btn-danger">Delete</button>
						<button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<div class="modal fade" id="conFirmSellLabel">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<form
					id="form-removeSellLabels" action="confirm_sell_label" method="post">
					<!-- Modal Header -->
					<div class="modal-header">
						<h4 class="modal-title">Confirm Sell Label</h4>
						<button type="button" class="close" data-dismiss="modal">&times;</button>
					</div>
					<!-- Modal body -->
					<div class="modal-body">
						<div class="form-sell">
							<input type="hidden" id="addSellID" name="sell_id" value="{{sellRow.id}}">
							<label for="sellNo">Do you want to confirm Sell No:
								{{sellRow.sell_no}}
								<span id="removeLabelNo"></span>
							</div>
							<div class="form-sell">
								<label for="sellNo">Total Quantity:
									{{sellRow.total_qty}}
									<span id="removeLabelNo"></span>
								</div>
							</div>
							<div class="modal-footer">
								<button type="submit" class="btn btn-success">Confirm</button>
								<button type="button" class="btn btn-info" data-dismiss="modal">Cancel</button>
							</div>
						</form>
					</div>
				</div>
			</div>

		{% endblock %}
